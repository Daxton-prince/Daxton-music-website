<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>DJ Daxton music website </title>
  <meta name="description" content="DJ mixes player — stream & download mixes in the palm of your hands ." />
  <style>
    :root{
      --bg:#071724;
      --icy-1:#8bd3ff;
      --icy-2:#dff7ff;
      --card:#0b2b3a;
      --gold:#ffd700;
    }
    *{box-sizing:border-box}
    html,body{height:100%;
    margin:0;
    font-family:Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
    color:var(--icy-2);
    background:linear-gradient(180deg,var(--bg),#04121a)}
    header{
          position: sticky; 
    top: 0;
    z-index: 999; 
    background: rgba(0, 0, 0, 0.2); 
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
      border-bottom: 1px solid rgba(255, 255, 255, 0.3);
    box-shadow: 0 2px 10px rgba(0,0,0,0.2);
}
    }
    .site-header{
    position: sticky; 
    top: 0;
    z-index: 999; 
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding:14px 18px;
      border-bottom:1px solid rgba(255,255,255,0.03);
      gap:12px;
      flex-wrap:wrap}
    .brand h1{margin:0;
    font-size:20px}
    .brand h1 span{color:var(--icy-1)}
    .subtitle{margin:4px 0 0;
    font-size:12px;
    color:rgba(223,247,255,0.8)}
    .controls{
      
      display:flex;
      gap:8px;
      align-items:center;
      flex:1;
      min-width:200px}
    .controls input[type="search"]{padding:8px 12px;
    border-radius:8px;
    border:1px solid rgba(255,255,255,0.06);
    background:transparent;
    color:var(--icy-2);
    min-width:160px;
    flex:1}
    .controls button{padding:8px 12px;border-radius:8px;
    border:none;
    background:linear-gradient(180deg,var(--icy-1),#6fcfff);
    color:#012;
    cursor:pointer}
    .controls button.toggle-fav.active{background:var(--gold);
    color:#012}
    main.container{padding:20px;
    max-width:1100px;
    margin:18px auto;
    flex:1}
    
    .mix-grid{display:grid;
    grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:18px}
    .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    border:1px solid rgba(255,255,255,0.03);
    padding:14px;
    border-radius:12px;box-shadow:0 6px 18px rgba(3,8,14,0.6);
    display:flex;
    flex-direction:column}
    .art{height:140px;
    border-radius:8px;
    background:linear-gradient(135deg,var(--icy-1),#2aa6ff);
    display:flex;
    align-items:center;
    justify-content:center;
    font-weight:700;color:#012;
    font-size:36px;
    user-select:none}
    .card h3{
      margin:10px 0 6px;
    font-size:16px}
    .meta{font-size:13px;
    color:rgba(223,247,255,0.75);
    display:flex;
    gap:8px;
    flex-wrap:wrap}
    .row{display:flex;
    gap:8px;align-items:center;
    margin-top:12px;
    flex-wrap:wrap}
    .btn{padding:8px 10px;
    border-radius:8px;border:none;background:rgba(255,255,255,0.06);color:var(--icy-2);
    cursor:pointer;text-decoration:none}
    .btn.play{background:linear-gradient(90deg,var(--icy-1),#6fcfff);
    color:#012}
    .btn.download{background:transparent;
    border:1px solid rgba(255,255,255,0.06)}
    
    .btn.favorite{font-size:18px;padding:6px 8px;
    background:transparent;
    color:var(--icy-2);
    border:none;
    cursor:pointer}
    .btn.favorite.active{color:var(--gold)}
    .small{font-size:12px;
    color:rgba(223,247,255,0.7)}
    .empty-state{text-align:center;
    color:rgba(223,247,255,0.5);
    margin-top:28px}
    footer{
          position: sticky; 
  bottom: -0;
    z-index: 999; 
        background: rgba(0, 0, 0, 0.2); 
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
      border-bottom: 1px solid rgba(255, 255, 255, 0.3);
    box-shadow: 0 2px 10px rgba(0,0,0,0.2);
    }
    .site-footer{text-align:center;
    padding:14px 0;
    color:rgba(223,247,255,0.4)}
    audio,video{width:100%;
    border-radius:8px;
    outline:none;
      
    }
    
    @media(max-width:520px){.brand h1{font-size:16px}
    .controls input[type="search"]{min-width:110px}}
  </style>
</head>
<body>
  <header class="site-header">
    <div class="brand">
      <h1>DJ <span id="dj-name">Daxton 254 </span></h1>
      <div class="subtitle">Stream • Preview • Download — Smooth as ice</div>
    </div>

    <div class="controls" role="search">
      <input id="search" type="search" placeholder="Search mixes, genre or year..." autocomplete="off" />
      <button id="refresh" title="Reload data">Refresh</button>
      <button id="toggle-favorites" class="toggle-fav" title="Show favorites only">★ Favorites</button>
    </div>
  </header>

  <main class="container">
    <section id="mixes" class="mix-grid" aria-live="polite"></section>
    <div id="empty" class="empty-state" style="display:none;">No mixes found — edit the JSON block inside this file to add mixes.</div>
  </main>

  <footer class="site-footer">
    <small>Built with ❤️ by  DJ Daxton .For easy downloading of my mixes dj Daxton 254 <i>The Intellectual Prince</i>.</small>
  </footer>

  <!-- EMBEDDED JSON DATA
       Edit this JSON array to add/remove mixes.
       For each Google Drive file, put the FILE_ID (the long code between /d/ and /view).
       The script constructs direct links: https://drive.google.com/uc?export=download&id=FILE_ID
  -->
  <script id="mixes-data" type="application/json">
[
  {
    "title": "Late Night Vibes",
    "genre": "Deep House",
    "year": 2025,
    "length": "1:12:34",
    "fileId": "1toT5FpqNwjkyzwVB1",
    "filename": "late-night-vibes.mp3",
    "type": "audio",
    "artText": "LN"
  },
  {
    "title": "Summer Live Set",
    "genre": "House",
    "year": 2024,
    "length": "48:20",
    "fileId": "FILE_ID_HERE_MP4",
    "filename": "summer-live.mp4",
    "type": "video",
    "artText": "SL"
  }
]
  </script>

  <script>
  /***** Single-file DJ Mixes player script *****/

  // Elements
  const mixesContainer = document.getElementById('mixes');
  const searchInput = document.getElementById('search');
  const refreshBtn = document.getElementById('refresh');
  const emptyState = document.getElementById('empty');
  const toggleFavBtn = document.getElementById('toggle-favorites');

  // State
  let mixesData = [];
  let showingFavorites = false;
  let currentFilter = '';
  let currentRenderedList = []; // currently rendered list (after filters)
  const FAVORITES_KEY = 'djmixes_favorites';
  const downloadCounts = {}; // in-memory counts

  /* Helpers */
  function makeDriveLink(id){
    if(!id) return '';
    return `https://drive.google.com/uc?export=download&id=${id}`;
  }

  function safeParseJSON(text){
    try { return JSON.parse(text); }
    catch(e){ console.error('JSON parse failed', e); return []; }
  }

  function getFavorites(){
    try { return JSON.parse(localStorage.getItem(FAVORITES_KEY)) || []; }
    catch { return []; }
  }
  function saveFavorites(list){ localStorage.setItem(FAVORITES_KEY, JSON.stringify(list)); }

  /* Load mixes from embedded JSON block */
  function loadMixesFromEmbedded(){
    const jsonText = document.getElementById('mixes-data').textContent.trim();
    mixesData = safeParseJSON(jsonText);
    // Basic validation: ensure array
    if(!Array.isArray(mixesData)) mixesData = [];
  }

  /* Render helpers */
  function updateDownloadCountUI(fileId){
    const el = document.querySelector(`[data-dlcount="${fileId}"]`);
    if(el) el.textContent = `Downloads: ${downloadCounts[fileId]||0}`;
  }

  function createCard(m){
    const card = document.createElement('article');
    card.className = 'card';
    card.setAttribute('data-fileid', m.fileId || '');

    // art
    const art = document.createElement('div');
    art.className = 'art';
    art.textContent = m.artText || (m.title||'Mix').slice(0,2).toUpperCase();
    card.appendChild(art);

    // title
    const title = document.createElement('h3');
    title.textContent = m.title || 'Untitled Mix';
    card.appendChild(title);

    // meta
    const meta = document.createElement('div');
    meta.className = 'meta';
    meta.innerHTML = `<span class="small">${m.genre||'Unknown'}</span><span class="small">${m.length||''}</span><span class="small">${m.year||''}</span>`;
    card.appendChild(meta);

    // player row
    const row = document.createElement('div');
    row.className = 'row';

    const src = makeDriveLink(m.fileId);
    if(m.type === 'video'){
      const vid = document.createElement('video');
      vid.controls = true;
      vid.preload = 'none';
      vid.src = src;
      vid.setAttribute('data-fileid', m.fileId);
      row.appendChild(vid);
    } else {
      const audio = document.createElement('audio');
      audio.controls = true;
      audio.preload = 'none';
      audio.src = src;
      audio.setAttribute('data-fileid', m.fileId);
      row.appendChild(audio);
    }

    card.appendChild(row);

    // buttons row
    const btnRow = document.createElement('div');
    btnRow.className = 'row';

    // favorite button
    const favBtn = document.createElement('button');
    favBtn.className = 'btn favorite';
    const favs = getFavorites();
    const isFav = favs.includes(m.fileId);
    if(isFav){ favBtn.classList.add('active'); favBtn.textContent = '★'; }
    else { favBtn.textContent = '☆'; }

    favBtn.title = isFav ? 'Remove from favorites' : 'Add to favorites';
    favBtn.onclick = (e) => {
      e.stopPropagation();
      let list = getFavorites();
      if(list.includes(m.fileId)) list = list.filter(id => id !== m.fileId);
      else list.push(m.fileId);
      saveFavorites(list);
      // re-render with same filter state
      applyFiltersAndRender();
    };
    btnRow.appendChild(favBtn);

    // download link
    const dl = document.createElement('a');
    dl.className = 'btn download';
    dl.href = src;
    dl.setAttribute('download', m.filename || 'mix');
    dl.textContent = 'Download';
    // increment counter on click
    dl.onclick = () => {
      downloadCounts[m.fileId] = (downloadCounts[m.fileId] || 0) + 1;
      updateDownloadCountUI(m.fileId);
      // allow normal download to proceed
      return true;
    };
    btnRow.appendChild(dl);

    // download count
    const dlCount = document.createElement('span');
    dlCount.className = 'small';
    dlCount.style.marginLeft = '8px';
    dlCount.setAttribute('data-dlcount', m.fileId);
    dlCount.textContent = `Downloads: ${downloadCounts[m.fileId]||0}`;
    btnRow.appendChild(dlCount);

    card.appendChild(btnRow);

    return card;
  }

  /* Render list */
  function renderMixes(list){
    mixesContainer.innerHTML = '';
    currentRenderedList = Array.isArray(list) ? list : [];

    if(!currentRenderedList || currentRenderedList.length === 0){
      emptyState.style.display = 'block';
      setupAutoPlayNext(); // nothing to do but keep it safe
      return;
    }
    emptyState.style.display = 'none';

    // Create and append cards
    currentRenderedList.forEach(m => {
      const card = createCard(m);
      mixesContainer.appendChild(card);
    });

    // After DOM nodes ready, setup autoplay on the rendered list
    setupAutoPlayNext();
  }

  /* Apply current filters (search + favorites toggle) */
  function applyFiltersAndRender(){
    currentFilter = (searchInput.value || '').toLowerCase().trim();

    let filtered = mixesData.filter(m => {
      // basic fields safety
      const title = (m.title||'').toLowerCase();
      const genre = (m.genre||'').toLowerCase();
      const year = (m.year||'').toString();
      const q = currentFilter;
      const matches = q === '' || title.includes(q) || genre.includes(q) || year.includes(q);
      return matches;
    });

    if(showingFavorites){
      const favs = getFavorites();
      filtered = filtered.filter(m => favs.includes(m.fileId));
    }

    renderMixes(filtered);
  }

  /* Search handler */
  searchInput.addEventListener('input', () => {
    applyFiltersAndRender();
  });

  /* Favorites toggle */
  toggleFavBtn.addEventListener('click', () => {
    showingFavorites = !showingFavorites;
    toggleFavBtn.classList.toggle('active', showingFavorites);
    applyFiltersAndRender();
  });

  /* Refresh — reload the embedded JSON block (useful if you edit the file on GitHub and reload page) */
  refreshBtn.addEventListener('click', () => {
    loadMixesFromEmbedded();
    applyFiltersAndRender();
  });

  /* Autoplay next track logic for the currently rendered list.
     It finds all audio/video elements inside the mixesContainer in document order.
     On 'ended', it locates the next media element and starts it. */
  function setupAutoPlayNext(){
    // remove previous handlers by cloning nodes? easier to re-query and rebind
    const mediaEls = mixesContainer.querySelectorAll('audio, video');
    if(!mediaEls || mediaEls.length === 0) return;

    // convert NodeList to array
    const arr = Array.from(mediaEls);

    // attach handlers
    arr.forEach((el, idx) => {
      // clear previous handlers to avoid double-binding
      el.onended = null;
      el.onended = () => {
        // pause all others
        arr.forEach(x => { try{ x.pause(); } catch(e){} });
        const nextIdx = idx + 1;
        if(nextIdx < arr.length){
          try {
            arr[nextIdx].play();
            arr[nextIdx].scrollIntoView({ behavior: 'smooth', block: 'center' });
          } catch(e){
            console.warn('Auto-play failed (browser may block).', e);
          }
        }
      };
    });
  }

  /* INIT */
  (function init(){
    loadMixesFromEmbedded();
    applyFiltersAndRender();
  })();

  </script>

</body>
</html>
